---
import { getEntry } from 'astro:content';

type Props = {
	tag: {
		id: string;
	};
};

const { tag, ...props } = Astro.props;

const tagData =
	tag.id == 'none'
		? { id: '', data: { name: 'None!' } }
		: await getEntry('tags', tag.id);

// Random rotation for rainbow gradient
const rotation = Math.floor(Math.random() * 18) * 20; // 0, 20, 40, ... 340
---

<a
	href={`/tag/${tagData.id}`}
	class="rainbow-tag"
	style={`--rotation: ${rotation}deg`}
>
	{/* eslint-disable-next-line react/jsx-props-no-spreading */}
	<span class="tag-content capitalize px-1" {...props}>
		{tagData.data.name}
	</span>
</a>

<style>
	.rainbow-tag {
		display: inline-block;
		padding: 1px;
		border-radius: 0.1875rem; /* 3px */
		background: conic-gradient(
			from var(--rotation, 0deg),
			hsl(0, 100%, 50%),
			/* red */ hsl(30, 100%, 50%),
			/* orange */ hsl(60, 100%, 50%),
			/* yellow */ hsl(120, 100%, 50%),
			/* green */ hsl(180, 100%, 50%),
			/* cyan */ hsl(240, 100%, 50%),
			/* blue */ hsl(280, 100%, 50%),
			/* violet */ hsl(0, 100%, 50%) /* back to red */
		);
		filter: brightness(0.9);
	}

	.tag-content {
		display: block;
		background: #f3f4f6; /* bg-gray-100 */
		border-radius: 0.125rem; /* 2px */
	}
</style>
